#  Set theory for SQL Joins

## UNION vs UNION ALL

1. Union takes two tables as input, and returns all records from both tables. If 2 records are identicals, UNION only returns them once.

2. UNION ALL takes two tables and returns all record from both tables, including duplicates.

```
-- UNION SYNTAX
SELECT * 
FROM left_table
UNION 
SELECT *
FROM right_table

-- UNION ALL SYNTAX
SELECT * 
FROM left_table
UNION ALL
SELECT *
FROM right_table

```

## Comparing global economies


```
-- Select all fields from economies2015
select *
from economies2015
-- Set operation
union
-- Select all fields from economies2019
select * 
from economies2019
ORDER BY code, year;

```

## Comparing two set operations
Perform an appropriate set operation that determines all pairs of country code and year (in that order) from economies and populations, excluding duplicates.
Order by country code and year.
 
```
-- Query that determines all pairs of code and year from economies and populations, without duplicates


select country_code, year
from populations
union
select code, year
from economies
order by country_code, year

```

Amend the query to return all combinations (including duplicates) of country code and year in the economies or the populations tables.


```
SELECT code, year
FROM economies
-- Set theory clause
UNION ALL
SELECT country_code, year
FROM populations
ORDER BY code, year;

```

UNION returned 434 records, whereas UNION ALL returned 814. 

## Intersect

* Takes two tables as input, and returns only the records that exist in both tables.


```
-- INTERSECT SYNTAX
SELECT * 
FROM left_table
INTERSECT
SELECT *
FROM right_table

```
* Intersect requires all fields to match, since in set operations we do not specify any fields to match on.
* Both tables must have the same number of columns in order to compare records.

* In INNER JOIN, similar to INTERSECT, only results where both fields match are returned.
* INNER JOIN will return duplicate values, whereas INTERSECT will only return common records once.


Return all city names that are also country names.

```
-- Return all cities with the same name as a country
select name 
from cities
intersect 
select name
from countries
```

## Except

It retains only records from the left table that are not present in the right table.

```
-- EXCEPT SYNTAX
SELECT * 
FROM left_table
EXCEPT
SELECT *
FROM right_table

```

Return all cities that do not have the same name as a country.

```
-- Return all cities that do not have the same name as a country
select name 
from cities 
except 
select name 
from countries
ORDER BY name;
```


## Calling all set operators
 
```


```