# Outer Joins, Cross Joins and Self Joins


## Histories and languages

Imagine you are a researcher interested in the languages spoken in two countries: Pakistan and India. You are interested in asking:

What are the languages presently spoken in the two countries?
Given the shared history between the two countries, what languages could potentially have been spoken in either country over the course of their history?

```
-- Code 1
SELECT c.name AS country, l.name AS language
-- Inner join countries as c with languages as l on code
from countries as c
inner join languages as l
on c.code=l.code
WHERE c.code IN ('PAK','IND')
	AND l.code in ('PAK','IND');
```


```
-- Code 2
SELECT c.name AS country, l.name AS language
FROM countries AS c
-- Perform a cross join to languages (alias as l)
cross join languages as l
WHERE c.code in ('PAK','IND')
	AND l.code in ('PAK','IND');
```

## Choosing your join

You will determine the names of the five countries and their respective regions with the lowest life expectancy for the year 2010. Use your knowledge about joins, filtering, sorting and limiting to create this list!

```
SELECT 
	c.name AS country,
    region,
    life_expectancy AS life_exp
FROM countries AS c
-- Join to populations (alias as p) using an appropriate join
left join populations as p
ON c.code = p.country_code
-- Filter for only results in the year 2010
where p.year = 2010
-- Sort by life_exp
order by life_exp asc
-- Limit to five records
limit 5;
```

## Comparing a country to itself

Self joins are very useful for comparing data from one part of a table with another part of the same table.

Suppose you are interested in finding out how much the populations for each country changed from 2010 to 2015. 
```
-- Select aliased fields from populations as p1
select p1.country_code, p1.size as size2010, p2.size as size2015
from populations as p1
-- Join populations as p1 to itself, alias as p2, on country code
inner join populations as p2
on p1.country_code = p2.country_code
```

Since you want to compare records from 2010 and 2015, eliminate unwanted records by extending the WHERE statement

```
SELECT 
	p1.country_code, 
    p1.size AS size2010, 
    p2.size AS size2015
FROM populations AS p1
INNER JOIN populations AS p2
ON p1.country_code = p2.country_code
WHERE p1.year = 2010
-- Filter such that p1.year is always five years before p2.year
and p1.year = p2.year-5
```

| country_code	| size2010	| size2015 |
|---|---| --- |
|ABW	| 101597	| 103889|
|AFG	|27962208	|32526562|
